import{S as Ie,i as De,s as Pe,d as u,w as de,x as oe,b as $,f as a,G as Te,E as Ue,c as K,e as o,l as X,g as p,h as V,m as M,k as O,j as Z,F as pe,o as h,t as F,q as B,u as Ne,H as re,I as Se,n as Ae,D as Oe,r as Be,J as je,v as Me,y as Fe,z as Re,A as Ye,K as qe}from"./Cv86gl7V.js";import{e as he}from"./edHmJeGV.js";import"./IHki7fMi.js";import{a as ie}from"./BzUZX5_t.js";import{P as He}from"./CVSRtxXX.js";function _e(s,e,t){const l=s.slice();return l[22]=e[t],l}function ve(s){let e,t,l=s[0].script_id+"",i;return{c(){e=h("p"),t=F("Script ID: "),i=F(l),this.h()},l(n){e=p(n,"P",{class:!0});var r=V(e);t=M(r,"Script ID: "),i=M(r,l),r.forEach(u),this.h()},h(){a(e,"class","text-xs text-gray-500")},m(n,r){K(n,e,r),o(e,t),o(e,i)},p(n,r){r&1&&l!==(l=n[0].script_id+"")&&$(i,l)},d(n){n&&u(e)}}}function be(s){let e,t,l,i="üé• Video Preview",n,r,k="üìã Copy Path",v,f,b,w,T,N,y,C,U,x,S;return{c(){e=h("div"),t=h("div"),l=h("span"),l.textContent=i,n=B(),r=h("button"),r.textContent=k,v=B(),f=h("video"),b=h("source"),T=F(`
					Your browser doesn't support video playback.`),N=B(),y=h("div"),C=h("a"),U=F("‚¨áÔ∏è Download Video"),this.h()},l(E){e=p(E,"DIV",{class:!0});var d=V(e);t=p(d,"DIV",{class:!0});var A=V(t);l=p(A,"SPAN",{class:!0,"data-svelte-h":!0}),Z(l)!=="svelte-1zwy0j"&&(l.textContent=i),n=O(A),r=p(A,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(r)!=="svelte-1qbowgo"&&(r.textContent=k),A.forEach(u),v=O(d),f=p(d,"VIDEO",{class:!0,style:!0});var P=V(f);b=p(P,"SOURCE",{src:!0,type:!0}),T=M(P,`
					Your browser doesn't support video playback.`),P.forEach(u),N=O(d),y=p(d,"DIV",{class:!0});var _=V(y);C=p(_,"A",{href:!0,download:!0,class:!0});var m=V(C);U=M(m,"‚¨áÔ∏è Download Video"),m.forEach(u),_.forEach(u),d.forEach(u),this.h()},h(){a(l,"class","text-sm font-semibold text-gray-300"),a(r,"class","text-xs text-purple-400 hover:text-purple-300"),a(t,"class","flex items-center justify-between mb-2"),re(b.src,w=s[3])||a(b,"src",w),a(b,"type","video/mp4"),f.controls=!0,a(f,"class","w-full rounded-lg bg-black mb-2"),Se(f,"max-height","400px"),a(C,"href",s[3]),a(C,"download",""),a(C,"class","flex-1 text-center px-3 py-2 bg-blue-600 hover:bg-blue-700 text-white text-xs font-semibold rounded transition-colors"),a(y,"class","flex gap-2"),a(e,"class","bg-gray-900 rounded-lg p-3")},m(E,d){K(E,e,d),o(e,t),o(t,l),o(t,n),o(t,r),o(e,v),o(e,f),o(f,b),o(f,T),o(e,N),o(e,y),o(y,C),o(C,U),x||(S=X(r,"click",s[15]),x=!0)},p(E,d){d&8&&!re(b.src,w=E[3])&&a(b,"src",w),d&8&&a(C,"href",E[3])},d(E){E&&u(e),x=!1,S()}}}function me(s){let e,t,l,i="üéµ Audio Preview",n,r,k="üìã Copy Path",v,f,b,w,T,N,y,C,U,x,S;return{c(){e=h("div"),t=h("div"),l=h("span"),l.textContent=i,n=B(),r=h("button"),r.textContent=k,v=B(),f=h("audio"),b=h("source"),T=F(`
					Your browser doesn't support audio playback.`),N=B(),y=h("div"),C=h("a"),U=F("‚¨áÔ∏è Download Audio"),this.h()},l(E){e=p(E,"DIV",{class:!0});var d=V(e);t=p(d,"DIV",{class:!0});var A=V(t);l=p(A,"SPAN",{class:!0,"data-svelte-h":!0}),Z(l)!=="svelte-m8dmry"&&(l.textContent=i),n=O(A),r=p(A,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(r)!=="svelte-1smih3r"&&(r.textContent=k),A.forEach(u),v=O(d),f=p(d,"AUDIO",{class:!0});var P=V(f);b=p(P,"SOURCE",{src:!0,type:!0}),T=M(P,`
					Your browser doesn't support audio playback.`),P.forEach(u),N=O(d),y=p(d,"DIV",{class:!0});var _=V(y);C=p(_,"A",{href:!0,download:!0,class:!0});var m=V(C);U=M(m,"‚¨áÔ∏è Download Audio"),m.forEach(u),_.forEach(u),d.forEach(u),this.h()},h(){a(l,"class","text-sm font-semibold text-gray-300"),a(r,"class","text-xs text-purple-400 hover:text-purple-300"),a(t,"class","flex items-center justify-between mb-2"),re(b.src,w=s[2])||a(b,"src",w),a(b,"type","audio/mpeg"),f.controls=!0,a(f,"class","w-full mb-2"),a(C,"href",s[2]),a(C,"download",""),a(C,"class","flex-1 text-center px-3 py-2 bg-blue-600 hover:bg-blue-700 text-white text-xs font-semibold rounded transition-colors"),a(y,"class","flex gap-2"),a(e,"class","bg-gray-900 rounded-lg p-3")},m(E,d){K(E,e,d),o(e,t),o(t,l),o(t,n),o(t,r),o(e,v),o(e,f),o(f,b),o(f,T),o(e,N),o(e,y),o(y,C),o(C,U),x||(S=X(r,"click",s[16]),x=!0)},p(E,d){d&4&&!re(b.src,w=E[2])&&a(b,"src",w),d&4&&a(C,"href",E[2])},d(E){E&&u(e),x=!1,S()}}}function ge(s){let e,t,l,i=s[0].error_message+"",n;return{c(){e=h("div"),t=h("p"),l=F("‚ùå Error: "),n=F(i),this.h()},l(r){e=p(r,"DIV",{class:!0});var k=V(e);t=p(k,"P",{class:!0});var v=V(t);l=M(v,"‚ùå Error: "),n=M(v,i),v.forEach(u),k.forEach(u),this.h()},h(){a(t,"class","text-xs text-red-300"),a(e,"class","bg-red-500/10 border border-red-500/30 rounded-lg p-3")},m(r,k){K(r,e,k),o(e,t),o(t,l),o(t,n)},p(r,k){k&1&&i!==(i=r[0].error_message+"")&&$(n,i)},d(r){r&&u(e)}}}function ke(s){let e,t,l="üì§ Publish",i,n;return{c(){e=h("div"),t=h("button"),t.textContent=l,this.h()},l(r){e=p(r,"DIV",{class:!0});var k=V(e);t=p(k,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(t)!=="svelte-1l39sfb"&&(t.textContent=l),k.forEach(u),this.h()},h(){a(t,"class","flex-1 px-4 py-2 bg-gradient-to-r from-green-600 to-blue-600 hover:from-green-700 hover:to-blue-700 text-white font-bold rounded-lg transition-all"),a(e,"class","flex gap-3")},m(r,k){K(r,e,k),o(e,t),i||(n=X(t,"click",s[17]),i=!0)},p:Ae,d(r){r&&u(e),i=!1,n()}}}function we(s){let e,t,l,i="üì§ Publish Video",n,r,k,v,f,b,w=s[5].length+"",T,N,y=s[5].length!==1?"s":"",C,U,x,S,E="Cancel",d,A,P=he(s[8]),_=[];for(let m=0;m<P.length;m+=1)_[m]=Ce(_e(s,P,m));return{c(){e=h("div"),t=h("div"),l=h("h3"),l.textContent=i,n=B(),r=h("div");for(let m=0;m<_.length;m+=1)_[m].c();k=B(),v=h("div"),f=h("button"),b=F("Publish to "),T=F(w),N=F(" platform"),C=F(y),x=B(),S=h("button"),S.textContent=E,this.h()},l(m){e=p(m,"DIV",{class:!0});var g=V(e);t=p(g,"DIV",{class:!0});var I=V(t);l=p(I,"H3",{class:!0,"data-svelte-h":!0}),Z(l)!=="svelte-aox504"&&(l.textContent=i),n=O(I),r=p(I,"DIV",{class:!0});var W=V(r);for(let J=0;J<_.length;J+=1)_[J].l(W);W.forEach(u),k=O(I),v=p(I,"DIV",{class:!0});var Q=V(v);f=p(Q,"BUTTON",{class:!0});var G=V(f);b=M(G,"Publish to "),T=M(G,w),N=M(G," platform"),C=M(G,y),G.forEach(u),x=O(Q),S=p(Q,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(S)!=="svelte-cq2964"&&(S.textContent=E),Q.forEach(u),I.forEach(u),g.forEach(u),this.h()},h(){a(l,"class","text-xl font-bold text-white mb-4"),a(r,"class","space-y-3 mb-6"),f.disabled=U=s[5].length===0,a(f,"class","flex-1 px-4 py-2 bg-purple-600 hover:bg-purple-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white font-semibold rounded-lg transition-colors"),a(S,"class","px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-lg transition-colors"),a(v,"class","flex gap-3"),a(t,"class","bg-gray-800 rounded-lg shadow-2xl w-full max-w-md mx-4 p-6"),a(e,"class","fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-40")},m(m,g){K(m,e,g),o(e,t),o(t,l),o(t,n),o(t,r);for(let I=0;I<_.length;I+=1)_[I]&&_[I].m(r,null);o(t,k),o(t,v),o(v,f),o(f,b),o(f,T),o(f,N),o(f,C),o(v,x),o(v,S),d||(A=[X(f,"click",s[10]),X(S,"click",s[19]),X(t,"click",je(s[14])),X(e,"click",s[20])],d=!0)},p(m,g){if(g&800){P=he(m[8]);let I;for(I=0;I<P.length;I+=1){const W=_e(m,P,I);_[I]?_[I].p(W,g):(_[I]=Ce(W),_[I].c(),_[I].m(r,null))}for(;I<_.length;I+=1)_[I].d(1);_.length=P.length}g&32&&w!==(w=m[5].length+"")&&$(T,w),g&32&&y!==(y=m[5].length!==1?"s":"")&&$(C,y),g&32&&U!==(U=m[5].length===0)&&(f.disabled=U)},d(m){m&&u(e),Oe(_,m),d=!1,Be(A)}}}function ye(s){let e,t="‚úì";return{c(){e=h("span"),e.textContent=t,this.h()},l(l){e=p(l,"SPAN",{class:!0,"data-svelte-h":!0}),Z(e)!=="svelte-94maj3"&&(e.textContent=t),this.h()},h(){a(e,"class","text-purple-400")},m(l,i){K(l,e,i)},d(l){l&&u(e)}}}function Ce(s){let e,t,l,i,n=s[22].icon+"",r,k,v,f=s[22].name+"",b,w,T=s[5].includes(s[22].id),N,y,C,U,x=T&&ye();function S(){return s[18](s[22])}return{c(){e=h("button"),t=h("div"),l=h("div"),i=h("span"),r=F(n),k=B(),v=h("span"),b=F(f),w=B(),x&&x.c(),N=B(),this.h()},l(E){e=p(E,"BUTTON",{class:!0});var d=V(e);t=p(d,"DIV",{class:!0});var A=V(t);l=p(A,"DIV",{class:!0});var P=V(l);i=p(P,"SPAN",{class:!0});var _=V(i);r=M(_,n),_.forEach(u),k=O(P),v=p(P,"SPAN",{class:!0});var m=V(v);b=M(m,f),m.forEach(u),P.forEach(u),w=O(A),x&&x.l(A),A.forEach(u),N=O(d),d.forEach(u),this.h()},h(){a(i,"class","text-2xl"),a(v,"class","text-white font-semibold"),a(l,"class","flex items-center gap-3"),a(t,"class","flex items-center justify-between"),a(e,"class",y="w-full p-4 rounded-lg border-2 transition-all text-left "+(s[5].includes(s[22].id)?"border-purple-500 bg-purple-500/10":"border-gray-600 bg-gray-900"))},m(E,d){K(E,e,d),o(e,t),o(t,l),o(l,i),o(i,r),o(l,k),o(l,v),o(v,b),o(t,w),x&&x.m(t,null),o(e,N),C||(U=X(e,"click",S),C=!0)},p(E,d){s=E,d&32&&(T=s[5].includes(s[22].id)),T?x||(x=ye(),x.c(),x.m(t,null)):x&&(x.d(1),x=null),d&32&&y!==(y="w-full p-4 rounded-lg border-2 transition-all text-left "+(s[5].includes(s[22].id)?"border-purple-500 bg-purple-500/10":"border-gray-600 bg-gray-900"))&&a(e,"class",y)},d(E){E&&u(e),x&&x.d(),C=!1,U()}}}function xe(s){let e,t;return e=new He({props:{taskId:s[7],title:"Publishing Video",onClose:s[21],onStop:s[11]}}),{c(){Ye(e.$$.fragment)},l(l){Re(e.$$.fragment,l)},m(l,i){Fe(e,l,i),t=!0},p(l,i){const n={};i&128&&(n.taskId=l[7]),i&66&&(n.onClose=l[21]),e.$set(n)},i(l){t||(oe(e.$$.fragment,l),t=!0)},o(l){de(e.$$.fragment,l),t=!1},d(l){Me(e,l)}}}function Le(s){let e,t,l,i,n,r=s[0].status+"",k,v,f,b,w=(s[0].generator||"unknown")+"",T,N,y,C,U=s[0].id+"",x,S,E,d,A='<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg>',P,_,m,g,I,W,Q,G,J,ae,ce,R=s[0].script_id&&ve(s),Y=s[0].video_path&&be(s),q=s[0].audio_path&&me(s),H=s[0].error_message&&ge(s),L=s[0].status==="completed"&&ke(s),z=s[4]&&we(s),j=s[6]&&xe(s);return{c(){e=h("div"),t=h("div"),l=h("div"),i=h("div"),n=h("span"),k=F(r),f=B(),b=h("span"),T=F(w),N=B(),y=h("p"),C=F("Video ID: "),x=F(U),S=B(),R&&R.c(),E=B(),d=h("button"),d.innerHTML=A,P=B(),_=h("div"),Y&&Y.c(),m=B(),q&&q.c(),g=B(),H&&H.c(),I=B(),L&&L.c(),W=B(),z&&z.c(),Q=B(),j&&j.c(),G=pe(),this.h()},l(c){e=p(c,"DIV",{class:!0});var D=V(e);t=p(D,"DIV",{class:!0});var le=V(t);l=p(le,"DIV",{class:!0});var ee=V(l);i=p(ee,"DIV",{class:!0});var se=V(i);n=p(se,"SPAN",{class:!0});var ue=V(n);k=M(ue,r),ue.forEach(u),f=O(se),b=p(se,"SPAN",{class:!0});var fe=V(b);T=M(fe,w),fe.forEach(u),se.forEach(u),N=O(ee),y=p(ee,"P",{class:!0});var ne=V(y);C=M(ne,"Video ID: "),x=M(ne,U),ne.forEach(u),S=O(ee),R&&R.l(ee),ee.forEach(u),E=O(le),d=p(le,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(d)!=="svelte-1pdyl8k"&&(d.innerHTML=A),le.forEach(u),P=O(D),_=p(D,"DIV",{class:!0});var te=V(_);Y&&Y.l(te),m=O(te),q&&q.l(te),g=O(te),H&&H.l(te),te.forEach(u),I=O(D),L&&L.l(D),D.forEach(u),W=O(c),z&&z.l(c),Q=O(c),j&&j.l(c),G=pe(),this.h()},h(){a(n,"class",v="text-xs px-2 py-1 "+Ve(s[0].status)+" rounded"),a(b,"class","text-xs px-2 py-1 bg-blue-500/20 text-blue-300 rounded"),a(i,"class","flex items-center gap-2 mb-2"),a(y,"class","text-sm text-gray-400"),a(l,"class","flex-1"),a(d,"class","text-red-400 hover:text-red-300 transition-colors"),a(t,"class","flex items-start justify-between mb-4"),a(_,"class","space-y-3 mb-4"),a(e,"class","bg-gray-800 rounded-lg p-6 shadow-lg border border-gray-700 hover:border-blue-500/50 transition-all")},m(c,D){K(c,e,D),o(e,t),o(t,l),o(l,i),o(i,n),o(n,k),o(i,f),o(i,b),o(b,T),o(l,N),o(l,y),o(y,C),o(y,x),o(l,S),R&&R.m(l,null),o(t,E),o(t,d),o(e,P),o(e,_),Y&&Y.m(_,null),o(_,m),q&&q.m(_,null),o(_,g),H&&H.m(_,null),o(e,I),L&&L.m(e,null),K(c,W,D),z&&z.m(c,D),K(c,Q,D),j&&j.m(c,D),K(c,G,D),J=!0,ae||(ce=X(d,"click",s[12]),ae=!0)},p(c,[D]){(!J||D&1)&&r!==(r=c[0].status+"")&&$(k,r),(!J||D&1&&v!==(v="text-xs px-2 py-1 "+Ve(c[0].status)+" rounded"))&&a(n,"class",v),(!J||D&1)&&w!==(w=(c[0].generator||"unknown")+"")&&$(T,w),(!J||D&1)&&U!==(U=c[0].id+"")&&$(x,U),c[0].script_id?R?R.p(c,D):(R=ve(c),R.c(),R.m(l,null)):R&&(R.d(1),R=null),c[0].video_path?Y?Y.p(c,D):(Y=be(c),Y.c(),Y.m(_,m)):Y&&(Y.d(1),Y=null),c[0].audio_path?q?q.p(c,D):(q=me(c),q.c(),q.m(_,g)):q&&(q.d(1),q=null),c[0].error_message?H?H.p(c,D):(H=ge(c),H.c(),H.m(_,null)):H&&(H.d(1),H=null),c[0].status==="completed"?L?L.p(c,D):(L=ke(c),L.c(),L.m(e,null)):L&&(L.d(1),L=null),c[4]?z?z.p(c,D):(z=we(c),z.c(),z.m(Q.parentNode,Q)):z&&(z.d(1),z=null),c[6]?j?(j.p(c,D),D&64&&oe(j,1)):(j=xe(c),j.c(),oe(j,1),j.m(G.parentNode,G)):j&&(Te(),de(j,1,1,()=>{j=null}),Ue())},i(c){J||(oe(j),J=!0)},o(c){de(j),J=!1},d(c){c&&(u(e),u(W),u(Q),u(G)),R&&R.d(),Y&&Y.d(),q&&q.d(),H&&H.d(),L&&L.d(),z&&z.d(c),j&&j.d(c),ae=!1,ce()}}}function Ee(s){navigator.clipboard.writeText(s),alert("Copied to clipboard!")}function Ve(s){switch(s){case"completed":return"bg-green-500/20 text-green-300";case"pending":return"bg-yellow-500/20 text-yellow-300";case"failed":return"bg-red-500/20 text-red-300";default:return"bg-gray-500/20 text-gray-300"}}function ze(s,e,t){let l,i,{video:n}=e,{onUpdate:r}=e,k=!1,v=[],f=!1,b="",w="";Ne(()=>{t(13,w=localStorage.getItem("auth_token")||""),console.log("[VideoCard] Token loaded:",w?`${w.substring(0,20)}...`:"EMPTY")});const T=[{id:"telegram",name:"Telegram",icon:"üì±",color:"blue"},{id:"youtube",name:"YouTube Shorts",icon:"‚ñ∂Ô∏è",color:"red"},{id:"tiktok",name:"TikTok",icon:"üéµ",color:"pink"},{id:"instagram",name:"Instagram Reels",icon:"üì∏",color:"purple"}];function N(g){v.includes(g)?t(5,v=v.filter(I=>I!==g)):t(5,v=[...v,g])}async function y(){if(v.length===0){alert("Select at least one platform");return}try{const g=await ie.publishVideo(n.id,v);t(7,b=g.task_id),t(4,k=!1),t(6,f=!0)}catch(g){alert(`Error publishing: ${g}`)}}async function C(){if(console.log("[VideoCard] handleCancelPublish called, taskId:",b),!b){console.error("[VideoCard] No currentTaskId!"),alert("No task to cancel");return}try{console.log("[VideoCard] Calling api.cancelTask..."),await ie.cancelTask(b),console.log("[VideoCard] Task cancelled successfully"),t(6,f=!1),t(7,b=""),alert("Publishing cancelled")}catch(g){console.error("[VideoCard] Error cancelling:",g),alert(`Error cancelling: ${g}`)}}async function U(){if(confirm("Delete this video?"))try{await ie.deleteVideo(n.id),r()}catch(g){alert(`Error deleting video: ${g}`)}}function x(g){qe.call(this,s,g)}const S=()=>Ee(n.video_path),E=()=>Ee(n.audio_path),d=()=>t(4,k=!0),A=g=>N(g.id),P=()=>t(4,k=!1),_=()=>t(4,k=!1),m=()=>{t(6,f=!1),r()};return s.$$set=g=>{"video"in g&&t(0,n=g.video),"onUpdate"in g&&t(1,r=g.onUpdate)},s.$$.update=()=>{s.$$.dirty&8193&&t(3,l=w?`/api/videos/${n.id}/download?token=${encodeURIComponent(w)}`:`/api/videos/${n.id}/download`),s.$$.dirty&8193&&t(2,i=w?`/api/videos/${n.id}/download-audio?token=${encodeURIComponent(w)}`:`/api/videos/${n.id}/download-audio`),s.$$.dirty&8205&&w&&n.id&&console.log("[VideoCard] Generated URLs:",{videoUrl:l,audioUrl:i})},[n,r,i,l,k,v,f,b,T,N,y,C,U,w,x,S,E,d,A,P,_,m]}class Xe extends Ie{constructor(e){super(),De(this,e,ze,Le,Pe,{video:0,onUpdate:1})}}export{Xe as V};
